---
title: Usage
description: How to use SCAPI
---

# Getting scapi
Our main scapi file can be found [here](https://raw.githubusercontent.com/Strawberry-Foundations/strawberry-chat/main/bot/scapi.py).
Simply place this file in the folder where you want to program your bot. You can find out how to use scapi in your code below. 

We also recommend that you take a look at our [scapi bot directory](https://github.com/Strawberry-Foundations/strawberry-chat/tree/main/bot) to get an overview of how a bot can be structured. 

# Using scapi in your code
Scapi gets easier with every update. To import Scapi, use Python's `import` statement:
```python
import scapi            # import basic scapi
from scapi import Scapi # import the scapi bot class
```

<Tip>We recommend using YAML for configuration files. You can install YAML using `pip` (`pip install pyyaml`)</Tip>

# Write your first bot (Stable v1.0.0 for [stbmv1](/stbchat/stbm))
<Warning>This documentation part only applies to scapi legacy v1.0.0-stbmv1</Warning>

Scapi has 2 different methods to write a bot. One method is newer and clearer, but is not yet fully developed. This is called `Commands`.

The other method is the original. This is more difficult, but can be adapted considerably more. This method is still used for pure `on_message` events to accept and process pure messages. 
This method is called `Original`

<Tip>We recommend using the command method as it offers more features & more support than the original method (e.g. permissions)</Tip>

<CodeGroup>
    ```python Commands Method
    import scapi                # This will import scapi
    from scapi import Scapi

    import yaml                 # Import yaml for configuration purposes
    from yaml import SafeLoader

    with open("default.yml", encoding="utf-8") as config_file:
        config = yaml.load(config_file, Loader=SafeLoader) # Load the configuration

    # Define some important variables
    username    = config["bot"]["username"]     
    token       = config["bot"]["token"]
    host        = config["server"]["host"]
    port        = config["server"]["port"]
    prefix      = config["bot"]["prefix"]

    Bot = Scapi.Bot(username=username, token=token, host=host, port=port) # Define the bot class
    Bot.login() # Login
    Bot.flag_handler(print_recv_msg=True, enable_user_input=True) # set some bot flags

    Bot.permission_handler(custom_list=["your_name"], owner="your_name") # manage your bot permissions

    # Basic bot command
    @Bot.command(name="test", arg_count=1, required_permissions=Scapi.Bot.PermissionLevel.CUSTOM)
    def test_command(username: str, args: list):
        Bot.send_message(f"""
            Username: {username}
            Args: {args}"""
            )
    
    # bot on_ready event
    @Bot.event
    def on_ready():
        print(f"{Bot.log_msg}{scapi.BLUE}{Bot.username} started successfully!{scapi.RESET}")
    
    # run the bot
    Bot.run(on_ready)
    ```

    ```python Original Method
    import scapi
    from scapi import Scapi

    import yaml
    from yaml import SafeLoader
    import threading

    with open("default.yml", encoding="utf-8") as config:
        conf = yaml.load(config, Loader=SafeLoader)

    username    = conf["bot"]["username"]
    token       = conf["bot"]["token"]
    host        = conf["server"]["host"]
    port        = conf["server"]["port"]
    prefix      = conf["bot"]["prefix"]

    Bot = Scapi.Bot(username=username, token=token, host=host, port=port)
    Bot.login()
    Bot.flag_handler(print_recv_msg=True, enable_user_input=True)


    def Commands():
        while True:
            try:
                message = Bot.recv_message(raw=True)
            
                if message.startswith("!hello"):
                    Bot.send_message(f"Hello, world!")
                        
            except: 
                Bot.logger(f"{scapi.RED}An unknown exception occured{scapi.RESET}", type=Scapi.LogLevel.ERROR)
                break


    @Bot.event
    def on_ready():
        print(f"{Bot.log_msg}{scapi.BLUE}{Bot.username} started successfully!{scapi.RESET}")
        
    BotThread = threading.Thread(target=Bot.run, args=(on_ready,))
    CommandThread = threading.Thread(target=Commands)

    BotThread.start()
    CommandThread.start()
    ```

</CodeGroup>

This is an example of what your configuration could look like (YAML)

```yaml
bot:
  id: 12345678
  username: "username"
  token: "token"
  prefix: "!"

server:
  host: "1.2.3.4"
  port: 1234

flags:
  enableUserInput: true
  printReceivedMessagesToTerminal: true
```

----
# Write your first bot (Canary >=v0.12.0 for [stbmv2](/stbchat/stbm))
<Warning>This documentation part only applies to scapi canary v0.12.0 (stbmv2) or higher</Warning>

<Warning>
    As of scapi v0.12.1, we will no longer support the [original method](/scapi/usage#write-your-first-bot-stable-v1-0-0-for-stbmv1). 

    To continue using the original method, we recommend the new `@on_message` method (Since v0.13). If functionality is missing, please open an [issue](https://github.com/Strawberry-Foundations/strawberry-chat/issues) on our [GitHub](https://github.com/Strawberry-Foundations/strawberry-chat/)
</Warning>

Scapi Canary is currently in an unstable development phase and is therefore updated frequently.
You can get Scapi Canary (`@json-communication`) [here](https://raw.githubusercontent.com/Strawberry-Foundations/strawberry-chat/json-communication/bot/scapi.py).
The following piece of code shows you how to make a simple bot with Scapi Canary

<CodeGroup>
    ```python @commands
    import scapi
    from scapi import Scapi

    import yaml
    from yaml import SafeLoader

    with open("default.yml", encoding="utf-8") as config_file:
        config = yaml.load(config_file, Loader=SafeLoader)

    username    = config["bot"]["username"]
    token       = config["bot"]["token"]
    host        = config["server"]["host"]
    port        = config["server"]["port"]
    prefix      = config["bot"]["prefix"]

    Bot = Scapi.Bot(username=username, token=token, host=host, port=port, json=True)
    Bot.login()
    Bot.flag_handler(print_recv_msg=True, enable_user_input=True)

    Bot.permission_handler(custom_list=["julian"], owner="julian")

    @Bot.command(name="test", arg_count=1, required_permissions=Scapi.Bot.PermissionLevel.CUSTOM)
    def test_command(username: str, args: list):
        Bot.send_message(f"""
            Username: {username}
            Args: {args}"""
            )

    @Bot.event
    def on_ready():
        Bot.logger(f"{scapi.BLUE}{Bot.username} started successfully!{scapi.RESET}", type=Scapi.LogLevel.INFO)
        
    Bot.run(on_ready)
    ```

    ```python @commands + @on_message (since v0.13)
    import scapi
    from scapi import Scapi

    import yaml
    from yaml import SafeLoader

    with open("default.yml", encoding="utf-8") as config_file:
        config = yaml.load(config_file, Loader=SafeLoader)

    username    = config["bot"]["username"]
    token       = config["bot"]["token"]
    host        = config["server"]["host"]
    port        = config["server"]["port"]
    prefix      = config["bot"]["prefix"]

    Bot = Scapi.Bot(username=username, token=token, host=host, port=port, json=True)
    Bot.login()
    Bot.flag_handler(print_recv_msg=True, enable_user_input=True)

    Bot.permission_handler(custom_list=["julian"], owner="julian")

    # New on_message method to process plain messages from the user
    @Bot.on_message(message="Hello")
    def on_hello_message(username: str):
        Bot.send_message(f"Hello {username}!")

    @Bot.command(name="test", arg_count=1, required_permissions=Scapi.Bot.PermissionLevel.CUSTOM)
    def test_command(username: str, args: list):
        Bot.send_message(f"""
            Username: {username}
            Args: {args}"""
            )

    @Bot.event
    def on_ready():
        Bot.logger(f"{scapi.BLUE}{Bot.username} started successfully!{scapi.RESET}", type=Scapi.LogLevel.INFO)
        
    Bot.run(on_ready)
    ```
    ```python Original Method (Deprecated since v0.12.1)
    # WARNING: This method is deprecated
    # WE WILL WORK ON A BETTER VERSION OF THIS METHOD

    import scapi
    from scapi import Scapi

    import yaml
    from yaml import SafeLoader
    import threading

    with open("default.yml", encoding="utf-8") as config:
        conf = yaml.load(config, Loader=SafeLoader)

    username    = conf["bot"]["username"]
    token       = conf["bot"]["token"]
    host        = conf["server"]["host"]
    port        = conf["server"]["port"]
    prefix      = conf["bot"]["prefix"]

    Bot = Scapi.Bot(username=username, token=token, host=host, port=port)
    Bot.login()
    Bot.flag_handler(print_recv_msg=True, enable_user_input=True)


    def Commands():
        while True:
            try:
                message = Bot.recv_message(raw=True)
            
                if message.startswith("!hello"):
                    Bot.send_message(f"Hello, world!")
                        
            except: 
                Bot.logger(f"{scapi.RED}An unknown exception occured{scapi.RESET}", type=Scapi.LogLevel.ERROR)
                break


    @Bot.event
    def on_ready():
        print(f"{Bot.log_msg}{scapi.BLUE}{Bot.username} started successfully!{scapi.RESET}")
        
    BotThread = threading.Thread(target=Bot.run, args=(on_ready,))
    CommandThread = threading.Thread(target=Commands)

    BotThread.start()
    CommandThread.start()
    ```
</CodeGroup>

Changing the value `json` to `False` will enable the compatibility mode. Note that this is not yet fully developed 
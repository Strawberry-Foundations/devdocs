---
title: EinfÃ¼hrung in den Strawberry Communication Standard
description: Dies sollte dir eine allgemeine Vorstellung davon geben, worum es bei dem Strawberry Communication Standard geht
---

# Was ist das?
Der Strawberry Communication Standard (Strawberry's Kommunikationsstandard) (*kurz stbm, **St**raw**b**erry Co**m**munication Standard*) ist ein Kommunikationstandard fÃ¼r unsere Projekte.
Das heiÃŸt das alle unsere Projekte, die was mit NachrichtenÃ¼bertragungen oder Ã¤hnliches zu tun haben, dieses System nutzen.

Aktuell haben wir 2 Hauptversionen des Strawberry Communication Standards. 
Um das alte System vom neuen System zu unterscheiden zu kÃ¶nnen, fÃ¼hren wir das Strawberry Communication System ein (kurz stbm).
Dieses Kommunikationssystem bildet einen Standard fÃ¼r Strawberry Chat und mÃ¶glicherweise fÃ¼r andere Projekte von Strawberry Foundations.

### Versionen des Strawberry Communication Standards
<Warning>
    Aktuell planen wir eine Umbennenung der kurzen Version vom Strawberry Communication Standard.
    Die aktuelle kurze Version ist `stbm` (***St**raw**b**erry Co**m**munication Standard*).
    Wir planen dies zu `stbc` umzubennenen um mÃ¶glicherweise weniger Verwirrung zu verursachen
</Warning>


<CardGroup cols={1}>
  <Card title="Strawberry Communication Standard v1" icon="toilet-paper" iconType="duotone" color="#55d799">
    Version 1 `(stbmv1/stbcv1)` ist eine "Legacy" Version und erhÃ¤lt keine Updates mehr.
    Diese Version sendete pure Python-Strings Ã¼ber Sockets und der Client empfÃ¤ngt diese ohne vieles entschlÃ¼sseln der Daten.
    Die Daten werden jediglich nur entkodiert.<br></br><br></br>

    <Accordion title="Hinweis" icon="info" iconType="duotone" color="#55d799">
        FÃ¼r diese Version bieten wir keinen weiteren Support an.
        Die letzte Strawberry Chat Version (v1.8.3) mit diesem Kommunikationssystem erschien am 10. Dezember 2023.
        Dies war die letzte Legacy Version von Strawberry Chat und wird mit der VerÃ¶ffentlichung von v1.10 oder v1.11 keinen weiteren Support erhalten.
    </Accordion>
  </Card>

  <Card title="Strawberry Communication Standard v2" icon="satellite-dish" iconType="duotone" color="#55d799">
    Version 2 `(stbmv2/stbcv2)` ist eine neue, verbesserte Version unseres Kommunikationssystemes.
    Diese verwendet JSON, um Nachrichten Ã¼ber den Benutzern zu Ã¼bertragen.
    Mit unserem neuen Kommunizierungsstandard kÃ¶nnen Nutzer nun ihre eigenen Message Builder erstellen und damit selber entscheiden wie eine Nachricht angezeigt sein soll,
    unabhÃ¤ngig davon wie der Server eigentlich die Nachrichten gesendet hÃ¤tte.<br></br><br></br>

    <Accordion title="Strawberry Communication Standard v2.1" icon="tower-cell" iconType="duotone" color="#55d799">
    ZusÃ¤tzlich gibt es noch Version 2.1 `(stbmv2.1)` fÃ¼r Nachrichten-Proxying, diese Version ist aber aktuell nicht verfÃ¼gbar.
    </Accordion>
  </Card>

  <Card title="Strawberry Communication Standard v3" icon="right-left-large" iconType="duotone" color="#55d799">
    Version 3 `(stbcv3)` wurde mit dem Rust-rewrite von Strawberry Chat verÃ¶ffentlicht.
    Diese Version implementiert das senden von JSON-Daten auf beiden Seiten (Server & Client).
    Das bedeutet, dass der Client dann auch JSON senden muss. Aufgrund von aktuellen Performanceproblemen steht dies aber noch nicht fest und kÃ¶nnte daher sich noch Ã¤ndern.
    Durch die Implementierung von JSON fÃ¼r den Client stehen viele neue MÃ¶glichkeiten offen. Dadurch kann der Client spezielle Daten am Server senden und dieser verarbeitet diese.
    So kÃ¶nnten Commands, die Client-spezifisch sind, am Server verarbeitet werden.

    Die VerÃ¶ffentlichung fand am 19. April 2024 statt. Version 3 ist nicht rÃ¼ckwÃ¤rtskompatibel.
  </Card>
</CardGroup>

### UnterstÃ¼tzung

| UnterstÃ¼tzte Features  | stbcv1 | stbcv2 | stbcv2.1 | stbcv3 |
|------------------------|--------|--------|----------|--------|
| Python StringsÂ¹        | âœ…    | âœ…     | âœ…      | âŒ     |
| pure String TransferÂ²  | âœ…    | âŒ     | âœ…      | âŒ     |
| KompatiblitÃ¤tsmodus    | âœ…    | âœ…     | âœ…      | âŒ     |
| JSON Server-to-ClientÂ³ | âŒ    | âœ…     | âœ…      | âœ…     |
| JSON Client-to-Serverâ´ | âŒ    | âŒ     | âŒ      | âœ…     |
| Msgpack                | âŒ    | âŒ     | âŒ      | âœ…     |


<AccordionGroup>
  <Accordion title="Python StringsÂ¹" icon="python" iconType="duotone" color="#55d799">
    Das Feature Python StringsÂ¹ bedeutet so viel wie "UnterstÃ¼tzung fÃ¼r reine Python-Strings".
    Dies sollte in jedem Fall immer "Ja"/"âœ…" sein, andersfalls kÃ¶nnen keine Strings verwendet werden.

    Die Interne Bezeichnung fÃ¼r Python Strings lautet `ps_com` oder `feat@ps`
  </Accordion>

  <Accordion title="pure String TransferÂ²" icon="arrow-right-arrow-left" iconType="duotone" color="#55d799">
    Das Feature "pure String Transfer" wird fÃ¼r die erste Version des Strawberry Communication Standards verwendet.
    Dieses Feature verwendet reine Python Strings zum austausch von Daten und Events.

    Die Interne Bezeichnung fÃ¼r pure String Transfer lautet `pST_com` oder `feat@pst`
  </Accordion>

  <Accordion title="JSON Server-to-ClientÂ³" icon="satellite-dish" iconType="duotone" color="#55d799">
    Das JSON Feature Server-to-Client ist die Weiterentwicklung von pure String Transfer und bietet nun eine kompakte Datenstruktur an,
    um einfach Daten und Events am Client zu senden. So kÃ¶nnen auch "leise" Events im Hintergrund passieren

    Die Interne Bezeichnung fÃ¼r JSON Server-to-Client lautet `json_stc` oder `json@stc`
  </Accordion>

  <Accordion title="JSON Client-to-ServerÂ³" icon="satellite" iconType="duotone" color="#55d799">
    Das JSON Feature Client-to-Server ist die Implementierung von JSON fÃ¼r den Server, sodass der Server nun JSON-Daten vom Client annimmt statt pure String TransferÂ² Daten.
    Die zweite Version des Strawberry Communication Standards verwendet von Client zum Server weiterhin pure String Transfer,
    wÃ¤hrend die dritte Version vermutlich JSON Client-to-Server verwendet.

    Die Interne Bezeichnung fÃ¼r JSON Client-to-Server lautet `json_cts` oder `json@cts`
  </Accordion>
</AccordionGroup>


# Datentypen (stbcv2)
Ab stbcv2 verwenden wir neue und eigene JSON-Datentypen.
Hier ist ein kleiner Ã¼berblick von unseren Datentypen

<AccordionGroup>
  <Accordion title="Nutzernachrichten (user_message)" icon="user" iconType="duotone" color="#55d799">
    Nutzernachrichten (`user_message`) sind Nachrichten die von einem Nutzer gesendet wurden.
    Der Datentyp beinhaltet wichtige Daten, wie z.B. der Nutzername, das Badge, die Rollenfarbe und am wichtigsten, die Nachricht des Nutzers.
    Die Struktur kÃ¶nnte sich mit stbcv3 Ã¤ndern.

    ```json JSON
    {
        "message_type": "user_message", 
        "username": "julian",
        "nickname": "Julian The Great",
        "badge": "ğŸ‘‘",
        "role_color": "\u001b[31m\u001b[1m",
        "avatar_url": "https://example.com/some-avatar-url.png",
        "message": {
            "content": "Hello World!"
        }
    }
    ```
  </Accordion>

  <Accordion title="Systemnachrichten (system_message)" icon="gear" iconType="duotone" color="#55d799">
    Systemnachrichten (`system_message`) sind Nachrichten die vom System gesendet wurden.
    Dort handelt es sich meist um Nachrichten, dass ein neuer Nutzer beigetreten ist, allerdings kÃ¶nnen Systemnachrichten auch die eingebauten Slash-Commands sein.
    Dieser Datentyp ist ziemlich kompakt und sehr klein. Dies kÃ¶nnte sich aber eventuell mit stbcv3 Ã¤ndern.

    ```json JSON
    {
        "message_type": "system_message", 
        "message": {
            "content": "Hello from the system!"
        }
    }
    ```
  </Accordion>

  <Accordion title="Benachrichtigungs-Backend (stbchat_notification)" icon="bell" iconType="duotone" color="#55d799">
    Benachrichtigungs-Backend (`stbchat_notification`) sind interne Nachrichtenevents die vom System gesendet wurden.
    Diese Nachricht siehst du nicht, aber fÃ¼hrt im Hintergrund ein Prozess aus, nÃ¤mlich der, um dir eine Desktop-Benachrichtigung zu senden.
    Dieser Datentyp ist etwas komplexer. Die Struktur dieses Datentypes kÃ¶nnte sich mit stbcv3 Ã¤ndern.

    ```json JSON
    {
        "message_type": "stbchat_notification",
        "title": "Strawberry Chat",
        "username": "Julian",
        "avatar_url": "https://example.com/some-avatar-url.png",
        "content": "Hello, Julian!",
        "bell": true
    }
    ```

  </Accordion>

  <Accordion title="ChatdatenÃ¼bertragungs-Backend (stbchat_backend)" icon="satellite" iconType="duotone" color="#55d799">
    ChatdatenÃ¼bertragungs-Backend (`stbchat_backend`) sind interne Nachrichtenevents die vom System gesendet wurden.
    Diese Nachricht siehst du nicht, aber fÃ¼hrt im Hintergrund ein Prozess aus. Dieser Prozess kann unterschiedlich sein.
    Aktuell sendet `stbchat_backend` nur den Nutzernamen an den Client zurÃ¼ck. Der Client kann den Nutzernamen dann fÃ¼r verschiedene Dinge verwenden.
    Dieser Datentyp ist aufgrund seiner Neuheit sehr klein. Mit stbcv3 oder vielleicht sogar stbcv2 erhÃ¤lt dieser Datentyp allerdings noch mehr Features und damit eine hÃ¶here Bedeutung.    

    ```json JSON
    {
        "message_type": "stbchat_backend", 
        "user_meta": {
            "username": "Julian"
        }
    }
    ```
  </Accordion>
</AccordionGroup>




# Was? Wieso? Wie?
Du wunderst dich vielleicht und fragst dich was das Ã¼berhaupt ist? Naja, dies ist wie 2 Socket Instanzen miteinander Kommunizieren.
Dies wurde ursprÃ¼nglich fÃ¼r Strawberry Chat entwickelt um Daten zwischen Server und Client, wie zum Beispiel Nutzername, Badge und Nachrichten zu senden,
aber wir haben uns dazu entschieden, ein kleines Tutorial zu geben wie du dieses System auch in deinem Client implementieren kannst!

<Tip>JSON-Kommunikation (JSON-Communication) ist auch ein anderer Name fÃ¼r unser Strawberry Communication Standard v2 (`stbmv2`). [Hier](/german/stbchat/stbm) kannst du mehr darÃ¼ber erfahren</Tip>

# Die Idee
Das originale Konzept dafÃ¼r wurde auf unserem Projekteboard auf GitHub [GitHub](https://github.com/orgs/Strawberry-Foundations/projects/1?pane=issue&itemId=44311144) am 10. November 2023 gepostet.
Beachte das dies aktuell nur in Deutsch zur VerfÃ¼gung steht. 

# Beispielcode

<Info>Dies ist ein sehr einfaches Beispiel fÃ¼r JSON-Kommunikation welches in Strawberry Chat verwendet wird</Info>

<CodeGroup>

    ```json JSON
    {
        "message_type": "user_message", // Typ der Nachricht, meist user_message
        "username": "julian", // Der Nutzername sollte komplett kleingeschrieben werden und ohne Leerzeichen
        "nickname": "Julian The Great", // Der Nickname kann jede Art von UTF-8 Zeichen sowie Leerzeichen beinhalten
        "badge": "ğŸ‘‘", // Emoji
        "role_color": "\u001b[31m\u001b[1m", // Dieses verwendet ANSI Farben, das Beispiel hier zeigt ein Rot mit Bold
        "message": {
            "content": "Hello World!"
        }
    }
    ```

    ```python Python
    # Receive code of the client
    def receive(sock):
        while threadFlag:
            try:
                message = sock.recv(2048).decode('utf-8')

                try: message = conv_json_data(message)
                except: message = message

                if message:
                    try:
                        try: message_type = message["message_type"]
                        except: message_type = "unknown"

                        if message_type == "user_message":
                        username    = message["username"]
                        nickname    = message["nickname"]
                        badge       = badge_handler(message["badge"])
                        role_color  = message["role_color"]
                        message     = message["message"]["content"]

                        if nickname == username:
                            fmt = f"[{current_time()}] {role_color}{username}{badge}:{CRESET} {message}"
                        else:
                            fmt = f"[{current_time()}] {role_color}{nickname} (@{username.lower()}){badge}:{CRESET} {message}"

                        print(fmt)

                    else:
                        message     = message["message"]["content"]
                        print(f"[{current_time()}] {message}")

                except Exception as e:
                    time.sleep(0.05)
                    message         = message["message"]["content"]
                    print(f"[{current_time()}] {message}")

            else: break

        except Exception as e:
            if experimental_debug_mode: print(f"{Fore.RED + BOLD}{Str[lang]['ConnectionInterrupt']}{Fore.RESET + CRESET}")
    pass
    ```

</CodeGroup>

# UnterstÃ¼tzte Versionen in Strawberry Chat

<Warning>
    Dies gilt nur fÃ¼r Strawberry Chat, kein anderes Programm
</Warning>

Siehe Tabelle



|                     | v1.8.0 - v1.8.2 ![](https://img.shields.io/badge/Legacy-green) | v1.8.3 ![](https://img.shields.io/badge/Legacy-gray) | v1.9.0 ![](https://img.shields.io/badge/Stable-success) |
|---------------------|----------------------------------------------------------------|---------------------------------------------------------|--------------------------------------------------------|
| Standard `<=2.4.0`  | âœ…                                                            | âœ…                                                      | âŒ                                                    | 
| Standard `v2.5.0`   | âŒ                                                            | âŒ                                                      | âœ…                                                    | 
| Standard `>=v2.5.1` | âœ… (CM)                                                       | âœ… (CM)                                                 | âœ… (CM)                                               | 
| Lite `<=v1.0.1`     | âœ…                                                            | âœ…                                                      | âŒ                                                    | 
| Lite `>=v1.1.0`     | âŒ                                                            | âŒ                                                      | âœ…                                                    | 
| Nano `<=v1.0.1`     | âœ…                                                            | âœ…                                                      | âŒ                                                    | 
| Nano `>=v1.1.0`     | âŒ                                                            | âŒ                                                      | âœ…                                                    | 
| Berryjuice-pico     | âœ…                                                            | âœ…                                                      | âŒ                                                    | 

<Tip>
    ### KompatiblitÃ¤tsmodus (CM)
    Seit Client v2.5.1 haben wir ein Feature hinzugefÃ¼gt welches Nutzern erlaubt, sich mit alten Servern zu verbinden.
    Dies heiÃŸt KompatiblitÃ¤tsmodus. Um den KompatiblitÃ¤tsmodus zu aktivieren musst du entweder `compatibility_mode: true` zu deinem Legacy Servereintrag hinzufÃ¼gen oder starte den Client mit dem `--compatibility-mode` Argument
</Tip>